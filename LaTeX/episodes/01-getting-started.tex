\section[Introduccion]{Episodio 1: Introducci\'on (entorno y datos)}

\subsection{Capa de aplicaci\'on de OpenMM}

\begin{frame}
\frametitle{Flujo general de OpenMM}
\begin{itemize}
  \item Cargar estructuras PDB/GROMACS/AMBER/CHARMM/TINKER desde los scripts oficiales (p.ej., \href{https://github.com/openmm/openmm/blob/master/examples/python-examples/simulatePdb.py}{\texttt{simulatePdb.py}}, \href{https://github.com/openmm/openmm/blob/master/examples/python-examples/simulateGromacs.py}{\texttt{simulateGromacs.py}}, \href{https://github.com/openmm/openmm/blob/master/examples/python-examples/simulateAmber.py}{\texttt{simulateAmber.py}} y \href{https://github.com/openmm/openmm/blob/master/examples/python-examples/simulateCharmm.py}{\texttt{simulateCharmm.py}}).
  \item Generar objetos `Topology`, `System` e `Integrator` y sincronizar `StateReporter`/`TrajectoryReporter` para registrar energ\'ias, fuerzas y coordenadas.
  \item Ejecutar integraciones con pasos definidos desde la capa de aplicaci\'on y guardar checkpoints con la rutina de OpenMM-Setup (User Guide ยง3.5-3.15).
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Entradas externas}
\begin{itemize}
  \item \href{https://github.com/openmm/openmm/blob/master/examples/python-examples/simulateAmber.py}{\texttt{simulateAmber.py}} acepta `.prmtop` + `.inpcrd`, mientras que \href{https://github.com/openmm/openmm/blob/master/examples/python-examples/simulateCharmm.py}{\texttt{simulateCharmm.py}} y \href{https://github.com/openmm/openmm/blob/master/examples/python-examples/simulateGromacs.py}{\texttt{simulateGromacs.py}} respetan sus formatos nativos.
  \item \href{https://github.com/openmm/openmm/blob/master/examples/python-examples/simulatePdb.py}{\texttt{simulatePdb.py}} es el punto de partida tradicional para dip\u00e9ptido de alanina o prote\'inas-ligando sin parametrizar.
  \item Todos incluyen funciones para modificar `reporters` y acomodar formatos de salida que luego procesaremos con scripts Python de an\'alisis.
\end{itemize}
\end{frame}

\subsection{Panorama y escalas}

\begin{frame}
\frametitle{Objetivos del episodio}
\begin{itemize}
  \item Conectar termodin\'amica, mec\'anica estad\'istica y simulaci\'on.
  \item Definir variables, funciones de estado y observables.
  \item Establecer el flujo de datos y el entorno de trabajo.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Escalas de tiempo y longitud}
\begin{align*}
  \Delta t_{\text{vibraciones}} &\sim 10^{-15}\,\mathrm{s},\\
  \Delta t_{\text{conformaciones}} &\sim 10^{-9}\,\mathrm{s}\ \text{a}\ 10^{-3}\,\mathrm{s},\\
  L_{\text{atomos}} &\sim 10^{-10}\,\mathrm{m},\quad L_{\text{proteinas}} \sim 10^{-8}\,\mathrm{m}.
\end{align*}
\begin{itemize}
  \item La simulaci\'on at\'omica resuelve escalas ultrarr\'apidas.
  \item La estad\'istica conecta microestados con promedios macrosc\'opicos.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Modelo microsc\'opico}
\begin{align*}
  \text{Estado} &= (\mathbf{r}_1,\dots,\mathbf{r}_N,\mathbf{p}_1,\dots,\mathbf{p}_N),\\
  \mathbf{p}_i &= m_i \dot{\mathbf{r}}_i.
\end{align*}
\begin{itemize}
  \item El sistema est\'a definido por $6N$ coordenadas en el espacio de fases.
  \item La energ\'ia potencial codifica la interacci\'on entre part\'iculas.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Del micro al macro}
\begin{align*}
  \langle A \rangle &= \int A(\mathbf{r},\mathbf{p})\,\rho(\mathbf{r},\mathbf{p})\,d\mathbf{r}\,d\mathbf{p},\\
  \bar{A} &= \lim_{T\to\infty}\frac{1}{T}\int_0^T A(t)\,dt.
\end{align*}
\begin{itemize}
  \item La ergodicidad conecta promedios temporales y de conjunto.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Pipeline de simulaci\'on}
\begin{enumerate}
  \item Preparaci\'on del sistema (topolog\'ia, coordenadas, par\'ametros).
  \item Definici\'on del Hamiltoniano y condiciones de contorno.
  \item Integraci\'on temporal y generaci\'on de trayectoria.
  \item An\'alisis estad\'istico de observables.
\end{enumerate}
\end{frame}

\subsection{Variables y estados}

\begin{frame}
\frametitle{Variables de estado}
\begin{align*}
  P,\;V,\;T,\;U,\;H=U+PV,\;G=H-TS,\;A=U-TS.
\end{align*}
\begin{itemize}
  \item Funciones de estado: dependen solo del estado macrosc\'opico.
  \item Funciones de trayectoria: trabajo $W$ y calor $Q$.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Primera ley y trabajo}
\begin{align*}
  dU &= \delta Q + \delta W,\\
  \delta W &= -P\,dV + \sum_i f_i\,dx_i.
\end{align*}
\begin{itemize}
  \item La energ\'ia interna cambia por intercambio de calor o trabajo.
  \item En simulaci\'on, $\delta W$ proviene de fuerzas sobre part\'iculas.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Segunda ley y entrop\'ia}
\begin{align*}
  dS &\ge \frac{\delta Q}{T},\\
  S &= \kb\ln \Omega.
\end{align*}
\begin{itemize}
  \item $\Omega$ es el n\'umero de microestados compatibles con el macroestado.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Potenciales termodin\'amicos}
\begin{align*}
  G &= U + PV - TS,\\
  A &= U - TS.
\end{align*}
\begin{itemize}
  \item $G$ minimiza a $T,P$ constantes; $A$ minimiza a $T,V$ constantes.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Relaciones diferenciales}
\begin{align*}
  dG &= -S\,dT + V\,dP + \sum_i \mu_i\,dN_i,\\
  dA &= -S\,dT - P\,dV + \sum_i \mu_i\,dN_i.
\end{align*}
\begin{itemize}
  \item Las derivadas parciales dan observables medibles.
\end{itemize}
\end{frame}

\subsection{Entrop\'ia y energ\'ia libre}

\begin{frame}
\frametitle{Microestados y macroestados}
\begin{align*}
  S &= \kb\ln \Omega,\quad \Omega = \sum_{\text{micro}} 1.
\end{align*}
\begin{itemize}
  \item Incrementos de entrop\'ia favorecen estados con m\'as configuraciones.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Energ\'ia libre y equilibrio}
\begin{align*}
  \Delta G &= \Delta H - T\Delta S,\\
  \Delta A &= \Delta U - T\Delta S.
\end{align*}
\begin{itemize}
  \item En equilibrio, $\Delta G=0$ para procesos a $T,P$ fijos.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Potencial qu\'imico}
\begin{align*}
  \mu_i &= \left(\frac{\partial G}{\partial N_i}\right)_{T,P,N_{j\ne i}}.
\end{align*}
\begin{itemize}
  \item Controla intercambios de materia y equilibrio de fases.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Relaci\'on con probabilidades}
\begin{align*}
  P(\text{estado}) &\propto e^{-\beta G},\quad \beta=1/(\kb T).
\end{align*}
\begin{itemize}
  \item La energ\'ia libre gobierna el peso estad\'istico de macroestados.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ejemplo: equilibrio A $\rightleftharpoons$ B}
\begin{align*}
  K &= e^{-\beta\Delta G},\\
  \Delta G &= -\kb T\ln K.
\end{align*}
\begin{itemize}
  \item La estabilidad relativa se expresa en t\'erminos de $\Delta G$.
\end{itemize}
\end{frame}

\subsection{Ensembles y partici\'on}

\begin{frame}
\frametitle{Ensembles cl\'asicos}
\begin{itemize}
  \item Microcan\'onico (NVE): $N,V,E$ fijos.
  \item Can\'onico (NVT): $N,V,T$ fijos.
  \item Isotermo-isob\'arico (NPT): $N,P,T$ fijos.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Funci\'on de partici\'on can\'onica}
\begin{align*}
  Z &= \frac{1}{h^{3N}N!}\int e^{-\beta H(\mathbf{r},\mathbf{p})}\,d\mathbf{r}\,d\mathbf{p}.
\end{align*}
\begin{itemize}
  \item Central para derivar energ\'ias libres y promedios.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Observables en NVT}
\begin{align*}
  \langle A \rangle &= \frac{1}{Z}\int A\,e^{-\beta H}\,d\mathbf{r}\,d\mathbf{p}.
\end{align*}
\begin{itemize}
  \item En simulaci\'on, se estiman con promedios temporales.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ensemble NPT}
\begin{align*}
  \Delta &= \int dV\,e^{-\beta PV}\,Z(N,V,T),\\
  G &= -\kb T\ln \Delta.
\end{align*}
\begin{itemize}
  \item Incluye fluctuaciones de volumen controladas por el barostato.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Fluctuaciones termodin\'amicas}
\begin{align*}
  C_V &= \frac{\langle E^2 \rangle-\langle E \rangle^2}{\kb T^2},\\
  \kappa_T &= \frac{\langle V^2 \rangle-\langle V \rangle^2}{\kb T\langle V \rangle}.
\end{align*}
\begin{itemize}
  \item Las fluctuaciones conectan estad\'istica y respuesta macrosc\'opica.
\end{itemize}
\end{frame}

\subsection{Hamiltoniano y din\'amica}

\begin{frame}
\frametitle{Hamiltoniano cl\'asico}
\begin{align*}
  H(\mathbf{r},\mathbf{p}) &= \sum_{i=1}^N \frac{\mathbf{p}_i^2}{2m_i} + U(\mathbf{r}).
\end{align*}
\begin{itemize}
  \item Se separa en energ\'ia cin\'etica y potencial.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ecuaciones de Hamilton}
\begin{align*}
  \dot{\mathbf{r}}_i &= \frac{\partial H}{\partial \mathbf{p}_i},\\
  \dot{\mathbf{p}}_i &= -\frac{\partial H}{\partial \mathbf{r}_i}.
\end{align*}
\begin{itemize}
  \item Equivalentes a la segunda ley de Newton.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ecuaciones de Newton}
\begin{align*}
  m_i\ddot{\mathbf{r}}_i &= -\nabla_i U(\mathbf{r}).
\end{align*}
\begin{itemize}
  \item La fuerza es el gradiente negativo del potencial.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Conservaci\'on de energ\'ia}
\begin{align*}
  \frac{dH}{dt} &= 0 \quad \text{(NVE ideal)}.
\end{align*}
\begin{itemize}
  \item La integraci\'on num\'erica introduce errores controlables.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Flujo en el espacio de fases}
\begin{align*}
  \frac{d\rho}{dt} &= \{\rho,H\} = 0 \quad \text{(ecuaci\'on de Liouville)}.
\end{align*}
\begin{itemize}
  \item La densidad de probabilidad se conserva en el flujo hamiltoniano.
\end{itemize}
\end{frame}

\subsection{Fuerzas y gradientes}

\begin{frame}
\frametitle{Fuerzas a partir del potencial}
\begin{align*}
  \mathbf{F}_i &= -\nabla_i U(\mathbf{r}).
\end{align*}
\begin{itemize}
  \item En MD, el coste dominante es evaluar $U$ y $\mathbf{F}_i$.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Potenciales de pares}
\begin{align*}
  U &= \sum_{i<j} u(r_{ij}),\quad r_{ij}=\lVert \mathbf{r}_i-\mathbf{r}_j \rVert.
\end{align*}
\begin{itemize}
  \item Simplifican la energ\'ia total con interacciones binarias.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ejemplo: Lennard-Jones}
\begin{align*}
  u_{\text{LJ}}(r) &= 4\epsilon\left[\left(\frac{\sigma}{r}\right)^{12}-\left(\frac{\sigma}{r}\right)^6\right].
\end{align*}
\begin{itemize}
  \item Repulsi\'on a corta distancia, atracci\'on a media distancia.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Energ\'ia electrost\'atica}
\begin{align*}
  u_{\text{C}}(r) &= \frac{1}{4\pi\epsilon_0}\frac{q_i q_j}{r_{ij}}.
\end{align*}
\begin{itemize}
  \item Dominante en sistemas biomoleculares.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Gradientes y Hessiano}
\begin{align*}
  \nabla U &\equiv \left(\frac{\partial U}{\partial r_1},\dots,\frac{\partial U}{\partial r_{3N}}\right),\\
  \Hessian &= \nabla\nabla U.
\end{align*}
\begin{itemize}
  \item El Hessiano describe curvaturas locales (modos normales).
\end{itemize}
\end{frame}

\subsection{Partici\'on y probabilidades}

\begin{frame}
\frametitle{Separaci\'on cin\'etica/potencial}
\begin{align*}
  Z &= Z_{\text{kin}}\,Z_{\text{conf}},\\
  Z_{\text{kin}} &= \prod_i \left(\frac{2\pi m_i}{\beta h^2}\right)^{3/2}.
\end{align*}
\begin{itemize}
  \item $Z_{\text{conf}}$ depende solo de $U(\mathbf{r})$.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Distribuci\'on de configuraciones}
\begin{align*}
  P(\mathbf{r}) &= \frac{e^{-\beta U(\mathbf{r})}}{Z_{\text{conf}}}.
\end{align*}
\begin{itemize}
  \item Base del muestreo Monte Carlo y MD con termostato.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Energ\'ia libre configuracional}
\begin{align*}
  A &= -\kb T\ln Z_{\text{conf}} + \text{const}.
\end{align*}
\begin{itemize}
  \item Relaciona el muestreo con $\Delta A$ entre estados.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Distribuci\'on de velocidades}
\begin{align*}
  P(\mathbf{v}) &\propto e^{-\beta \sum_i \frac{1}{2}m_i v_i^2}.
\end{align*}
\begin{itemize}
  \item Permite inicializar velocidades a temperatura $T$.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Teorema de equipartici\'on}
\begin{align*}
  \langle K \rangle &= \frac{3N}{2}\kb T.
\end{align*}
\begin{itemize}
  \item Cada grado de libertad cuadr\'atico aporta $\frac{1}{2}\kb T$.
\end{itemize}
\end{frame}

\subsection{Distribuci\'on de Boltzmann}

\begin{frame}
\frametitle{Forma general}
\begin{align*}
  P(E) &= \frac{1}{Z}e^{-\beta E}.
\end{align*}
\begin{itemize}
  \item El peso exponencial penaliza estados de alta energ\'ia.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Distribuci\'on de Maxwell-Boltzmann}
\begin{align*}
  f(v) &= 4\pi\left(\frac{m}{2\pi\kb T}\right)^{3/2} v^2 e^{-\frac{mv^2}{2\kb T}}.
\end{align*}
\begin{itemize}
  \item Caracteriza la distribuci\'on de velocidades en equilibrio.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Interpretaci\'on estad\'istica}
\begin{itemize}
  \item La mayor\'ia de part\'iculas se agrupan alrededor de $v_{\text{m}}$.
  \item El ensanchamiento crece con $T$.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ejemplo gr\'afico}
\begin{center}
  \includegraphics[width=0.7\linewidth]{episodes/mb_distribution_helium_5500K.png}
\end{center}
\vspace{-0.1cm}
{\tiny Fuente: Wikimedia Commons (CC BY-SA 3.0). \cita{img-mb-5500k}}
\end{frame}

\begin{frame}
\frametitle{Aplicaci\'on en simulaci\'on}
\begin{itemize}
  \item Inicializar velocidades seg\'un $f(v)$ evita sesgos t\'ermicos.
  \item Permite comprobar que el termostato reproduce el equilibrio.
\end{itemize}
\end{frame}

\subsection{Espacio de fases y ergodicidad}

\begin{frame}
\frametitle{Espacio de fases}
\begin{align*}
  \Gamma &= (\mathbf{r},\mathbf{p}) \in \mathbb{R}^{6N}.
\end{align*}
\begin{itemize}
  \item Cada punto representa un microestado completo.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ecuaci\'on de Liouville}
\begin{align*}
  \frac{\partial \rho}{\partial t} + \{\rho,H\} = 0.
\end{align*}
\begin{itemize}
  \item El volumen en $\Gamma$ se conserva (teorema de Liouville).
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ergodicidad}
\begin{align*}
  \lim_{T\to\infty}\frac{1}{T}\int_0^T A(t)\,dt &= \langle A \rangle_{\text{ensemble}}.
\end{align*}
\begin{itemize}
  \item Supuesto clave para sustituir promedios de conjunto por tiempo.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Trayectorias en $\Gamma$}
\begin{center}
  \includegraphics[width=0.62\linewidth]{episodes/pendulum_phase_portrait.png}
\end{center}
\vspace{-0.1cm}
{\tiny Fuente: Wikimedia Commons (CC BY-SA 4.0). \cita{img-pendulum-phase}}
\end{frame}

\begin{frame}
\frametitle{Interpretaci\'on f\'isica}
\begin{itemize}
  \item \`Orbitas cerradas: movimiento peri\'odico.
  \item \`Orbitas abiertas: difusi\'on en regiones de alta energ\'ia.
\end{itemize}
\end{frame}

\subsection{Superficie de energ\'ia potencial}

\begin{frame}
\frametitle{Definici\'on}
\begin{align*}
  U(\mathbf{r}) &: \mathbb{R}^{3N} \to \mathbb{R}.
\end{align*}
\begin{itemize}
  \item Describe el paisaje energ\'etico donde se mueve el sistema.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Coordenadas de reacci\'on}
\begin{align*}
  \xi &= \xi(\mathbf{r}),\quad F(\xi) = -\kb T\ln P(\xi).
\end{align*}
\begin{itemize}
  \item Proyecci\'on que resume la din\'amica en una coordenada clave.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Barreras y estados metaestables}
\begin{itemize}
  \item M\'inimos locales: conformaciones metaestables.
  \item Barreras: controlan las escalas de transici\'on.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ejemplo de superficie}
\begin{center}
  \includegraphics[width=0.7\linewidth]{episodes/pes_sn1.png}
\end{center}
\vspace{-0.1cm}
{\tiny Fuente: Wikimedia Commons (CC BY-SA 4.0). \cita{img-pes-sn1}}
\end{frame}

\begin{frame}
\frametitle{Din\'amica sobre la superficie}
\begin{itemize}
  \item Integraci\'on cl\'asica produce trayectorias en $U(\mathbf{r})$.
  \item Los termostatos aseguran muestreo can\'onico.
\end{itemize}
\end{frame}

\subsection{Campos de fuerza}

\begin{frame}
\frametitle{Descomposici\'on del potencial}
\begin{align*}
  U &= U_{\text{bond}} + U_{\text{angle}} + U_{\text{dihedral}} + U_{\text{nonbond}}.
\end{align*}
\begin{itemize}
  \item Separaci\'on entre t\'erminos enlazados y no enlazados.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{T\'erminos enlazados}
\begin{align*}
  U_{\text{bond}} &= \sum_b k_b (r_b-r_b^0)^2,\\
  U_{\text{angle}} &= \sum_a k_a (\theta_a-\theta_a^0)^2.
\end{align*}
\begin{itemize}
  \item Aproximaci\'on arm\'onica alrededor de geometr\'ias de equilibrio.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Dihedros y rotaci\'on}
\begin{align*}
  U_{\text{dihedral}} &= \sum_d \frac{V_d}{2}\left[1+\cos(n_d\phi_d-\gamma_d)\right].
\end{align*}
\begin{itemize}
  \item Controlan barreras rotacionales y preferencias conformacionales.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Ejemplo LJ}
\begin{center}
  \includegraphics[width=0.68\linewidth]{episodes/lennard_jones_potential.png}
\end{center}
\vspace{-0.1cm}
{\tiny Fuente: Wikimedia Commons (CC BY-SA 4.0). \cita{img-lj-potential}}
\end{frame}

\begin{frame}
\frametitle{Par\'ametros y validaci\'on}
\begin{itemize}
  \item Los campos de fuerza se ajustan a datos cu\'anticos y experimentales.
  \item La validaci\'on incluye densidades, energ\'ias y conformaciones.
\end{itemize}
\end{frame}

\subsection{Entorno y datos}

\begin{frame}
\frametitle{Directorio de trabajo}
\begin{itemize}
  \item Variable de entorno \texttt{COURSE\_DIR}.
  \item Estructura: \texttt{data/} (entradas) y \texttt{results/} (salidas).
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Sistemas del curso}
\begin{itemize}
  \item Sistema simple: alanina.
  \item Sistema complejo: prote\'ina + ligando.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Flujo de datos}
\begin{enumerate}
  \item Descarga de datos base.
  \item Preparaci\'on de topolog\'ia y coordenadas.
  \item Validaci\'on del entorno de c\'alculo.
\end{enumerate}
\end{frame}

\begin{frame}
\frametitle{Reproducibilidad}
\begin{itemize}
  \item Controlar versiones de librer\'ias y semillas aleatorias.
  \item Guardar archivos de entrada y scripts.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Resumen del episodio}
\begin{itemize}
  \item La base termodin\'amica se conecta con el muestreo estad\'istico.
  \item El potencial define fuerzas y probabilidades.
  \item El entorno de trabajo garantiza reproducibilidad.
\end{itemize}
\end{frame}

% ------------------------------------------------------------
